{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useCustomFetch } from \"./useCustomFetch\";\nexport function useTransactionsByEmployee() {\n  _s();\n\n  const {\n    fetchWithoutCache,\n    fetchWithCache,\n    loading\n  } = useCustomFetch();\n  const [transactionsByEmployee, setTransactionsByEmployee] = useState(null);\n  const [allEmployeeTransactions, setAllEmployeeTransactions] = useState();\n  const fetchAllEmployeeTransactions = useEffect(() => {\n    const getData = async () => {\n      const employeeData = await fetchWithoutCache(\"employees\");\n\n      if (employeeData) {\n        const employeeTransactions = employeeData.map(async employee => await fetchWithCache(\"transactionsByEmployee\", {\n          employeeId: employee.id\n        }));\n        let transasctions = [];\n        employeeTransactions.forEach(employee => {\n          employee.then(transaction => {\n            transasctions === null || transasctions === void 0 ? void 0 : transasctions.push(transaction);\n          });\n        });\n        setAllEmployeeTransactions(transasctions);\n      }\n    };\n\n    getData();\n  }, []);\n  const fetchById = useCallback(employeeId => {\n    if (allEmployeeTransactions) {\n      const pickedEmployee = allEmployeeTransactions.filter(employee => {\n        return employee === null || employee === void 0 ? void 0 : employee.every(_ref => {\n          let {\n            employee\n          } = _ref;\n          return employee.id === employeeId;\n        });\n      })[0];\n      setTransactionsByEmployee(pickedEmployee);\n    }\n  }, [allEmployeeTransactions]);\n  const invalidateData = useCallback(() => {\n    setTransactionsByEmployee(null);\n  }, []);\n  return {\n    data: transactionsByEmployee,\n    setAllEmployeeTransactions,\n    loading,\n    fetchById,\n    invalidateData\n  };\n}\n\n_s(useTransactionsByEmployee, \"lO8BA7yLMxEm74HuaAAbMyTuYZ8=\", false, function () {\n  return [useCustomFetch];\n});","map":{"version":3,"names":["useCallback","useEffect","useState","useCustomFetch","useTransactionsByEmployee","fetchWithoutCache","fetchWithCache","loading","transactionsByEmployee","setTransactionsByEmployee","allEmployeeTransactions","setAllEmployeeTransactions","fetchAllEmployeeTransactions","getData","employeeData","employeeTransactions","map","employee","employeeId","id","transasctions","forEach","then","transaction","push","fetchById","pickedEmployee","filter","every","invalidateData","data"],"sources":["/home/edison/TakeHomeWork/Ramp/ramp-fe-challenge/src/hooks/useTransactionsByEmployee.ts"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\"\nimport { RequestByEmployeeParams, Transaction } from \"../utils/types\"\nimport { TransactionsByEmployeeResult } from \"./types\"\nimport { useCustomFetch } from \"./useCustomFetch\"\nimport { Employee } from \"../utils/types\"\n\nexport function useTransactionsByEmployee(): TransactionsByEmployeeResult {\n  const { fetchWithoutCache, fetchWithCache, loading } = useCustomFetch()\n  const [transactionsByEmployee, setTransactionsByEmployee] = useState<Transaction[] | null>(null)\n  const [allEmployeeTransactions, setAllEmployeeTransactions] = useState<Array<Transaction[] | null>>()\n\n  const fetchAllEmployeeTransactions = useEffect(() => {\n    const getData = async () => {\n      const employeeData = await fetchWithoutCache<Employee[]>(\"employees\")\n      if (employeeData) {\n        const employeeTransactions = employeeData.map(\n          async (employee) =>\n            await fetchWithCache<Transaction[], RequestByEmployeeParams>(\"transactionsByEmployee\", {\n              employeeId: employee.id,\n            })\n        )\n        let transasctions: Array<Transaction[] | null> = []\n        employeeTransactions.forEach((employee) => {\n          employee.then((transaction) => {\n            transasctions?.push(transaction)\n          })\n        })\n        setAllEmployeeTransactions(transasctions)\n      }\n    }\n    getData()\n  }, [])\n\n  const fetchById = useCallback(\n    (employeeId: string) => {\n      if (allEmployeeTransactions) {\n        const pickedEmployee = allEmployeeTransactions.filter((employee) => {\n          return employee?.every(({ employee }) => employee.id === employeeId)\n        })[0]\n        setTransactionsByEmployee(pickedEmployee)\n      }\n    },\n    [allEmployeeTransactions]\n  )\n\n  const invalidateData = useCallback(() => {\n    setTransactionsByEmployee(null)\n  }, [])\n\n  return { data: transactionsByEmployee, setAllEmployeeTransactions, loading, fetchById, invalidateData }\n}\n"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;AAGA,SAASC,cAAT,QAA+B,kBAA/B;AAGA,OAAO,SAASC,yBAAT,GAAmE;EAAA;;EACxE,MAAM;IAAEC,iBAAF;IAAqBC,cAArB;IAAqCC;EAArC,IAAiDJ,cAAc,EAArE;EACA,MAAM,CAACK,sBAAD,EAAyBC,yBAAzB,IAAsDP,QAAQ,CAAuB,IAAvB,CAApE;EACA,MAAM,CAACQ,uBAAD,EAA0BC,0BAA1B,IAAwDT,QAAQ,EAAtE;EAEA,MAAMU,4BAA4B,GAAGX,SAAS,CAAC,MAAM;IACnD,MAAMY,OAAO,GAAG,YAAY;MAC1B,MAAMC,YAAY,GAAG,MAAMT,iBAAiB,CAAa,WAAb,CAA5C;;MACA,IAAIS,YAAJ,EAAkB;QAChB,MAAMC,oBAAoB,GAAGD,YAAY,CAACE,GAAb,CAC3B,MAAOC,QAAP,IACE,MAAMX,cAAc,CAAyC,wBAAzC,EAAmE;UACrFY,UAAU,EAAED,QAAQ,CAACE;QADgE,CAAnE,CAFK,CAA7B;QAMA,IAAIC,aAA0C,GAAG,EAAjD;QACAL,oBAAoB,CAACM,OAArB,CAA8BJ,QAAD,IAAc;UACzCA,QAAQ,CAACK,IAAT,CAAeC,WAAD,IAAiB;YAC7BH,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEI,IAAf,CAAoBD,WAApB;UACD,CAFD;QAGD,CAJD;QAKAZ,0BAA0B,CAACS,aAAD,CAA1B;MACD;IACF,CAjBD;;IAkBAP,OAAO;EACR,CApB6C,EAoB3C,EApB2C,CAA9C;EAsBA,MAAMY,SAAS,GAAGzB,WAAW,CAC1BkB,UAAD,IAAwB;IACtB,IAAIR,uBAAJ,EAA6B;MAC3B,MAAMgB,cAAc,GAAGhB,uBAAuB,CAACiB,MAAxB,CAAgCV,QAAD,IAAc;QAClE,OAAOA,QAAP,aAAOA,QAAP,uBAAOA,QAAQ,CAAEW,KAAV,CAAgB;UAAA,IAAC;YAAEX;UAAF,CAAD;UAAA,OAAkBA,QAAQ,CAACE,EAAT,KAAgBD,UAAlC;QAAA,CAAhB,CAAP;MACD,CAFsB,EAEpB,CAFoB,CAAvB;MAGAT,yBAAyB,CAACiB,cAAD,CAAzB;IACD;EACF,CAR0B,EAS3B,CAAChB,uBAAD,CAT2B,CAA7B;EAYA,MAAMmB,cAAc,GAAG7B,WAAW,CAAC,MAAM;IACvCS,yBAAyB,CAAC,IAAD,CAAzB;EACD,CAFiC,EAE/B,EAF+B,CAAlC;EAIA,OAAO;IAAEqB,IAAI,EAAEtB,sBAAR;IAAgCG,0BAAhC;IAA4DJ,OAA5D;IAAqEkB,SAArE;IAAgFI;EAAhF,CAAP;AACD;;GA5CezB,yB;UACyCD,c"},"metadata":{},"sourceType":"module"}